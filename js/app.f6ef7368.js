(function(e){function t(t){for(var s,o,i=t[0],l=t[1],c=t[2],d=0,_=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&_.push(r[o][0]),r[o]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);u&&u(t);while(_.length)_.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],s=!0,i=1;i<a.length;i++){var l=a[i];0!==r[l]&&(s=!1)}s&&(n.splice(t--,1),e=o(o.s=a[0]))}return e}var s={},r={app:0},n=[];function o(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=s,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(a,s,function(t){return e[t]}.bind(null,s));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var u=l;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"07d3":function(e,t,a){},"2aab":function(e,t,a){},"44c0":function(e,t,a){"use strict";var s=a("4c42"),r=a.n(s);r.a},"4c42":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("cadf"),a("551c"),a("f751"),a("097d");var s=a("2b0e"),r=a("69b4"),n=(a("f9e3"),a("2dd8"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[e._m(0),a("hr"),a("button",{directives:[{name:"v-b-toggle",rawName:"v-v-b-toggle.instructions",modifiers:{instructions:!0}}],staticClass:"btn-link"},[e._v("Instructions")]),a("b-collapse",{staticClass:"mt-2",attrs:{id:"instructions"}},[a("b-card",[a("div",{staticClass:"card-text"},[e._v("\n          This is a demonstration of loading GWAS results via the web browser, fetching only the\n          data\n          required for that region. It relies on four assumptions:\n          "),a("ol",[a("li",[e._v("Your data has been stored in a compressed format, and indexed using Tabix. The\n              index file must be in the same path, with the suffix "),a("em",[e._v(".tbi")])]),a("li",[e._v("The data is hosted in a place that is reachable by web browser (eg local files\n              or a service such as S3)\n            ")]),a("li",[e._v("If using a remote URL, the host location must support byte range requests. ("),a("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Range_requests#Checking_if_a_server_supports_partial_requests"}},[e._v("how\n              to check")]),e._v(")\n            ")]),a("li",[e._v("Your file contains information required to draw a plot. Chromosome, position,\n              ref, and alt alleles can be specified as either individual columns, or a SNP\n              marker (eg "),a("code",[e._v("chr:pos_ref/alt")]),e._v("); there must also be a p-value\n              (or -log10 pvalue) for each SNP as a separate column. Beta, SE, and alt allele\n              frequency information are optional, but will be used on the plot if provided.\n              "),a("em",[e._v("Client-side plots cannot be generated from rsIDs.")])])]),a("p",[e._v("This service is designed to efficiently fetch only the data needed for the plot\n            region of interest. Therefore, it cannot generate summary views that would require\n            processing the entire file (eg Manhattan plots).\n          ")]),a("p",[e._v("\n            LD and overlay information is based on a specific build ("),a("strong",[e._v("build GRCh37")]),e._v("\n            or "),a("strong",[e._v("build GRCh38")]),e._v(" are supported). Exercise caution when interpreting\n            plots based on a GWAS with positions from a different build.\n          ")]),a("p",[e._v("\n            Credible sets are\n            "),a("a",{attrs:{href:"https://github.com/statgen/gwas-credible-sets/"}},[e._v("calculated")]),e._v(" based on the\n            p-values for the displayed region. At the moment this tool does not support\n            uploading your own custom credible set annotations.\n          ")])])])],1)],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("gwas-toolbar",{attrs:{max_studies:4},on:{"config-ready":e.receiveAssocOptions,"select-range":e.updateRegion}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("plot-panes",{ref:"plotWidget",attrs:{dynamic_urls:!0,assoc_layout:e.base_assoc_layout,assoc_sources:e.base_assoc_sources,study_names:e.study_names,has_credible_sets:e.has_credible_sets,build:e.build,chr:e.chr,start:e.start,end:e.end}})],1)]),e._m(1)])}),o=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("h1",[a("strong",[e._v("LocalZoom: Plot your own data with LocusZoom.js")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("footer",{staticStyle:{"text-align":"center"}},[e._v("\n        Â© Copyright 2019 "),a("a",{attrs:{href:"https://github.com/statgen"}},[e._v("The University of Michigan\n        Center for Statistical Genetics")]),a("br")])])])}],i=a("5843"),l=a("205f"),c=a("39ba"),u=(a("8e6e"),a("f559"),a("456d"),a("bd86")),d=a("75fc"),_=(a("ac6a"),a("8615"),a("a481"),a("c5f6"),a("ee1d"),a("0d6d"),a("1f87")),p=a.n(_),f=(a("e3de"),"https://portaldev.sph.umich.edu/api/v1/"),h="https://portaldev.sph.umich.edu/ld/",m=/(?:chr)?(\w+)\s*:\s*(\d+)/,v=/(?:chr)?(\w+)\s*:\s*(\d+)-(\d+)/,b=a("768b"),g=(a("28a5"),a("7872"),a("4917"),a("7cdf"),a("5df3"),a("4f7f"),new Set(["",".","NA","N/A","n/a","nan","-nan","NaN","-NaN","null","NULL","None",null])),y=/^(?:chr)?([a-zA-Z0-9]+?):(\d+)[_:]?(\w+)?[/:|]?([^_]+)?_?(.*)?/,w=/([\d.-]+)([\sxeE]*)([0-9-]*)/;function C(e){return Number.isInteger(e)}function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e.map((function(e){return t.has(e)?a:e}))}function k(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=e.match(y);if(a)return a.slice(1);if(t)return null;throw new Error("Could not understand marker format. Must be of format chr:pos or chr:pos_ref/alt")}function S(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null===e)return e;var a=+e;if(t)return a;if(a<0||a>1)throw new Error("p value is not in the allowed range");if(0===a){if("0"===e)return 1/0;var s=e.match(w),r=Object(b["a"])(s,4),n=r[1],o=r[3];return n=+n,o=""!==o?+o:0,0===n?1/0:-(Math.log10(+n)+ +o)}return-Math.log10(a)}function O(e){var t,a=e.freq,s=e.allele_count,r=e.n_samples,n=e.is_alt_effect,o=void 0===n||n;if(void 0!==a&&void 0!==s)throw new Error("Frequency and allele count options are mutually exclusive");if(void 0===a&&(g.has(s)||g.has(r)))return null;if(void 0===a&&void 0!==s)t=+s/+r/2;else{if(g.has(a))return null;t=+a}if(t<0||t>1)throw new Error("Allele frequency is not in the allowed range");return o?t:1-t}function P(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.marker_col,a=e.chrom_col,s=e.pos_col,r=e.ref_col,n=e.alt_col,o=e.pvalue_col,i=e.beta_col,l=e.stderr_beta_col,c=e.allele_freq_col,u=e.allele_count_col,d=e.n_samples_col,_=e.is_alt_effect,p=void 0===_||_,f=e.is_neg_log_pvalue,h=void 0!==f&&f,m=e.delimiter,v=void 0===m?"\t":m;if(C(t)&&C(a)&&C(s))throw new Error("Must specify either marker OR chr + pos");if(!(C(t)||C(a)&&C(s)))throw new Error("Must specify how to locate marker");if(C(u)&&C(c))throw new Error("Allele count and frequency options are mutually exclusive");if(C(u)&&!C(d))throw new Error("To calculate allele frequency from counts, you must also provide n_samples");return function(e){var _,f,m,y,w,x,P,A=e.split(v),j=null;if(C(t)){var E=k(A[t-1],!1),q=Object(b["a"])(E,4);_=q[0],f=q[1],m=q[2],y=q[3]}else{if(!C(a)||!C(s))throw new Error("Must specify how to parse file");_=A[a-1].replace(/^chr/g,""),f=A[s-1]}C(r)&&(m=A[r-1]),C(n)&&(y=A[n-1]),g.has(m)&&(m=null),g.has(y)&&(y=null);var N=S(A[o-1],h);m=m||null,y=y||null,C(c)&&(w=A[c-1]),C(u)&&(x=A[u-1],P=A[d-1]);var L=C(i)?+A[i-1]:null,R=C(l)?+A[l-1]:null;(c||u)&&(j=O({freq:w,allele_count:x,n_samples:P,is_alt_effect:p}));var $=m&&y?"_".concat(m,"/").concat(y):"";return{chromosome:_,position:+f,ref_allele:m?m.toUpperCase():null,alt_allele:y?y.toUpperCase():null,log_pvalue:N,variant:"".concat(_,":").concat(f).concat($),beta:L,stderr_beta:R,alt_allele_freq:j}}}P({chrom_col:1,pos_col:2,ref_col:3,alt_col:4,pvalue_col:5,beta_col:6,stderr_beta_col:7,is_neg_log_pvalue:!0,delimiter:"\t"});function A(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?A(Object(a),!0).forEach((function(t){Object(u["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var E=Object.freeze({chr:"chrom",start:"start",end:"end"});function q(e){return e.replace(/[^A-Za-z0-9_]/g,"_")}function N(e){var t,a,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{credible_sets:!1,gwas_catalog:!0},r=(arguments.length>2&&arguments[2],[]),n=q(e),o={assoc:"assoc_".concat(n),credset:"credset_".concat(n),catalog:"catalog"},i=p.a.Layouts.get("panel","association",{id:"association_".concat(n),title:{text:e},namespace:o}),l=i.data_layers[2];l.label={text:"{{{{namespace[assoc]}}variant}}",spacing:12,lines:{style:{"stroke-width":"2px",stroke:"#333333","stroke-dasharray":"2px 2px"}},filters:[{field:"lz_show_label",operator:"=",value:!0}],style:{"font-weight":"bold"}},l.tooltip=p.a.Layouts.get("tooltip","standard_association_with_label",{namespace:o});var c=l.tooltip;c.html+="{{#if {{namespace[assoc]}}beta}}<br>&beta;: <strong>{{{{namespace[assoc]}}beta|scinotation|htmlescape}}</strong>{{/if}}",c.html+="{{#if {{namespace[assoc]}}stderr_beta}}<br>SE (&beta;): <strong>{{{{namespace[assoc]}}stderr_beta|scinotation|htmlescape}}</strong>{{/if}}",c.html+="{{#if {{namespace[assoc]}}alt_allele_freq}}<br>Alt. freq: <strong>{{{{namespace[assoc]}}alt_allele_freq|scinotation|htmlescape}} </strong>{{/if}}";var u=[];Object.values(s).some((function(e){return!!e}))&&u.push({type:"display_options",position:"right",color:"blue",button_html:"Display options...",button_title:"Control how plot items are displayed",layer_name:"associationpvalues",default_config_display_name:"Default view",options:[]});var _=["{{namespace[assoc]}}beta","{{namespace[assoc]}}stderr_beta","{{namespace[assoc]}}alt_allele_freq"];if(s.credible_sets){var f,h=p.a.Layouts.get("panel","association_credible_set",{namespace:o});(f=u[0].options).push.apply(f,Object(d["a"])(h.dashboard.components.pop().options)),_.push("{{namespace[credset]}}posterior_prob","{{namespace[credset]}}contrib_fraction","{{namespace[credset]}}is_member"),c.html+="<br>Posterior probability: <strong>{{{{namespace[credset]}}posterior_prob|scinotation}}</strong><br>"}if(s.gwas_catalog){var m,v=p.a.Layouts.get("panel","association_catalog",{namespace:o});(m=u[0].options).push.apply(m,Object(d["a"])(v.dashboard.components.pop().options)),_.push("{{namespace[catalog]}}rsid","{{namespace[catalog]}}trait","{{namespace[catalog]}}log_pvalue"),c.html+='{{#if {{namespace[catalog]}}rsid}}<br><a href="https://www.ebi.ac.uk/gwas/search?query={{{{namespace[catalog]}}rsid}}" target="_new">See hits in GWAS catalog</a>{{/if}}'}return(t=l.fields).push.apply(t,_),(a=i.dashboard.components).push.apply(a,u),r.push(p.a.Layouts.get("panel","association",i)),s.gwas_catalog&&r.push(p.a.Layouts.get("panel","annotation_catalog",{id:"catalog_".concat(n),namespace:o,dashboard:{components:[]},title:{text:"Hits in GWAS Catalog",style:{"font-size":"14px"},x:50}})),r}function L(e,t,a){var s="assoc_".concat(q(e)),r=j({},a,{id_field:"variant"});return[[s,["TabixAssociationLZ",{tabix_reader:t,params:r}]],["credset_".concat(q(e)),["CredibleSetLZ",{params:{fields:{log_pvalue:"".concat(s,":log_pvalue")},threshold:.95}}]]]}function R(e,t,a,s){s.forEach((function(e){return t.add.apply(t,Object(d["a"])(e))})),a.forEach((function(t){t.y_index=-1;var a=e.addPanel(t);a.addBasicLoader()}))}function $(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[].concat(Object(d["a"])(e),[["catalog",["GwasCatalogLZ",{url:"".concat(f,"annotation/gwascatalog/results/")}]],["ld",["LDLZ2",{url:h,params:{source:"1000G",population:"ALL"}}]],["gene",["GeneLZ",{url:"".concat(f,"annotation/genes/")}]],["recomb",["RecombLZ",{url:"".concat(f,"annotation/recomb/results/")}]],["constraint",["GeneConstraintLZ",{url:"https://gnomad.broadinstitute.org/api"}]]])}function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=[].concat(Object(d["a"])(t),[p.a.Layouts.get("panel","genes",{proportional_height:.5})]),r=p.a.Layouts.get("dashboard","standard_plot",{unnamespaced:!0});r.components.push(p.a.Layouts.get("dashboard_components","ldlz2_pop_selector"));var n=Object.assign({state:e,dashboard:r,panels:s},a);return p.a.Layouts.get("plot","standard_association",n)}function z(e,t){return Object.keys(e).reduce((function(a,s){var r=s.replace(/.*?:/,"");return Object.prototype.hasOwnProperty.call(a,r)&&t&&!s.startsWith(t)||(a[r]=e[s]),a}),{})}p.a.KnownDataSources.extend("AssociationLZ","TabixAssociationLZ",{parseInit:function(e){this.params=e.params,this.parser=P(this.params),this.reader=e.tabix_reader},getCacheKey:function(e,t,a){return[e.chr,e.start,e.end].join("_")},fetchRequest:function(e,t,a){var s=this;return new Promise((function(t,a){s.reader.fetch(e.chr,e.start,e.end,(function(e,s){s&&a(new Error("Could not read requested region. This may indicate an error with the .tbi index.")),t(e)}))}))},normalizeResponse:function(e){return e.map(this.parser).filter((function(e){return!Number.isNaN(e.log_pvalue)}))}});var G=function(e){var t=window.history[e];return function(){for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];var n=t.apply(this,s),o=new Event(e);return o.arguments=s,window.dispatchEvent(o),n}},M=function(){window.gtag&&window.gtag("event","regionview")};window.gtag&&(window.history.pushState=G("pushState"),window.addEventListener("popstate",M),window.addEventListener("pushState",M));var B=M,D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-card",{attrs:{"no-body":""}},[a("b-tabs",{staticClass:"flex-nowrap",staticStyle:{"min-height":"1000px"},attrs:{pills:"",card:"",vertical:"","content-class":"scroll-extra"},model:{value:e.selected_tab,callback:function(t){e.selected_tab=t},expression:"selected_tab"}},[a("b-tab",{attrs:{title:"GWAS"}},[e.has_studies?a("lz-plot",{attrs:{show_loading:!0,base_layout:e.assoc_layout,base_sources:e.assoc_sources,chr:e.chr,start:e.start,end:e.end,dynamic_urls:e.dynamic_urls},on:{element_clicked:e.onVariantClick,connected:e.receivePlot}}):a("div",{staticClass:"placeholder-plot",staticStyle:{display:"table"}},[a("span",{staticClass:"text-center",staticStyle:{display:"table-cell","vertical-align":"middle"}},[e._v("\n              Please add a GWAS track to continue\n            ")])])],1),a("b-tab",{attrs:{disabled:!e.has_studies||!e.allow_phewas}},[a("template",{slot:"title"},[a("span",{attrs:{title:"Only available for build GRCh37 datasets"}},[e._v("PheWAS")])]),a("phewas-maker",{attrs:{variant_name:e.tmp_phewas_variant,build:e.build,your_study:e.tmp_phewas_study,your_logpvalue:e.tmp_phewas_logpvalue,allow_render:e.selected_tab===e.PHEWAS_TAB}})],2),a("b-tab",{attrs:{title:"Export",disabled:!e.has_studies}},[a("export-data",{attrs:{has_credible_sets:e.has_credible_sets,study_names:e.study_names,table_data:e.table_data},on:{"requested-data":e.subscribeFields}})],1)],1)],1)],1)},F=[],W=a("6190"),V=a("f902"),U=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("label",[e._v("Select a study:\n        "),a("select",{directives:[{name:"model",rawName:"v-model",value:e.selected_study,expression:"selected_study"}],staticStyle:{width:"20em"},attrs:{disabled:0===e.study_names.length},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selected_study=t.target.multiple?a:a[0]}}},[a("option",{attrs:{value:""}},[e._v("(none selected)")]),e._l(e.study_names,(function(t,s){return a("option",{key:s,domProps:{value:t}},[e._v(e._s(t))])}))],2)])])]),e.selected_study?a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("button",{staticClass:"btn btn-info float-right",attrs:{disabled:!e.selected_study},on:{click:e.exportCSV}},[e._v("Download")])])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("tabulator-table",{attrs:{columns:e.table_config,"initial-sort":[{column:"log_pvalue",dir:"desc"}],height:"300px",table_data:e.table_data},on:{connected:function(t){e.table=t}}})],1)])]):a("p",[e._v('Please select a study to use the "export" feature.')])])},Z=[],I=(a("6762"),a("2fdb"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{ref:"table"},[e._t("default")],2)])}),H=[],J=a("39ab"),K=a.n(J),Y=(a("2bd6"),{name:"TabulatorTable",props:{table_data:Array,columns:Array,initialSort:Array,layout:{default:"fitData"},layoutColumnsOnNewData:{default:!0,type:Boolean},height:{default:"100%"}},beforeCreate:function(){this.tabulator=null},watch:{table_data:{handler:function(e){this.tabulator.setData(e)},deep:!0},columns:{handler:function(e){this.tabulator.setColumns(e),this.tabulator.setSort(e)},deep:!0}},mounted:function(){var e=this.table_data,t=this.columns,a=this.initialSort,s=this.layout,r=this.layoutColumnsOnNewData,n=this.height;this.tabulator=new K.a(this.$refs.table,{data:e,columns:t,initialSort:a,layout:s,layoutColumnsOnNewData:r,height:n}),this.$emit("connected",this.tabulator)}}),X=Y,Q=a("2877"),ee=Object(Q["a"])(X,I,H,!1,null,null,null),te=ee.exports;function ae(e,t){var a=e.getValue();return p.a.TransformationFunctions.get("scinotation")(a)}var se={name:"ExportData",props:["study_names","has_credible_sets","table_data"],beforeCreate:function(){this.table=null},data:function(){return{selected_study:"",export_type:"top_hits"}},computed:{source_name:function(){return q(this.selected_study||"")},table_config:function(){var e=[{title:"Chrom",field:"chromosome"},{title:"Pos",field:"position",sorter:"number"},{title:"Ref",field:"ref_allele"},{title:"Alt",field:"alt_allele"},{title:"-log<sub>10</sub>(p)",field:"log_pvalue",formatter:ae,sorter:"number"},{title:"&beta;",field:"beta",formatter:"money",formatterParams:{precision:3},sorter:"number"},{title:"SE(&beta;)",field:"stderr_beta",formatter:"money",formatterParams:{precision:3},sorter:"number"},{title:"Alt freq.",field:"alt_allele_freq",formatter:"money",formatterParams:{precision:3},sorter:"number"}];return this.has_credible_sets&&e.push({title:"Cred. set",field:"is_member",formatter:"tickCross"},{title:"Posterior probability",field:"posterior_prob",formatter:ae}),e}},watch:{source_name:function(){var e=this.source_name;if(this.study_names.includes(this.selected_study)){var t=["assoc_".concat(e,":chromosome"),"assoc_".concat(e,":position"),"assoc_".concat(e,":ref_allele"),"assoc_".concat(e,":alt_allele"),"assoc_".concat(e,":log_pvalue"),"assoc_".concat(e,":alt_allele_freq"),"assoc_".concat(e,":beta"),"assoc_".concat(e,":stderr_beta")];this.has_credible_sets&&t.push("credset_".concat(e,":is_member"),"credset_".concat(e,":posterior_prob")),this.$emit("requested-data",t)}else this.$emit("requested-data",[])}},methods:{exportCSV:function(){this.table.download("csv","results_".concat(this.source_name,".csv"))}},components:{TabulatorTable:te}},re=se,ne=Object(Q["a"])(re,U,Z,!1,null,"3ca8543e",null),oe=ne.exports,ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"lz-container-responsive",attrs:{id:e.dom_id}},[e._t("default")],2)])},le=[],ce=a("57c8"),ue=0,de={name:"LzPlot",props:{base_layout:{type:Object},base_sources:{type:Array},chr:{type:String},start:{type:Number},end:{type:Number},show_loading:{type:Boolean,default:!1},dynamic_urls:{default:!1}},beforeCreate:function(){ue+=1,this.dom_id="lz-plot-".concat(ue),this.plot_id=this.dom_id.replace(/-/g,"_"),this.plot=null,this.data_sources=null},mounted:function(){this.createLZ(this.base_layout,this.base_sources)},beforeDestroy:function(){delete window[this.plot_id]},computed:{region:function(){var e=this.chr,t=this.start,a=this.end;return{chr:e,start:t,end:a}}},methods:{createLZ:function(e,t){var a=JSON.parse(JSON.stringify(e)),s=new p.a.DataSources;t.forEach((function(e){var t=Object(b["a"])(e,2),a=t[0],r=t[1];return s.add(a,r)}));var r=p.a.populate("#".concat(this.dom_id),s,a);this.show_loading&&r.layout.panels.forEach((function(e){return r.panels[e.id].addBasicLoader()})),this.plot=r,this.data_sources=s,window[this.plot_id]=r,this.connectListeners(r),this.$emit("connected",r,s)},connectListeners:function(e){var t=this;Object.keys(e.event_hooks).forEach((function(a){return e.on(a,(function(e){return t.$emit(a,e)}))})),e.on("state_changed",(function(a){var s=e.state,r=s.chr,n=s.start,o=s.end,i=Object.keys(a.data).some((function(e){return["chr","start","end"].includes(e)}));i&&t.$emit("region_changed",{chr:r,start:n,end:o})})),this.dynamic_urls&&(Object(ce["plotUpdatesUrl"])(e,E),Object(ce["plotWatchesUrl"])(e,E))}},watch:{region:{handler:function(){var e=this,t=Object.assign({},this.region),a=Object.keys(t).reduce((function(a,s){var r=t[s];return r!==e.plot.state[s]&&(a[s]=r),a}),{});Object.keys(a).length&&this.plot.applyState(a)},deep:!0}}},_e=de,pe=Object(Q["a"])(_e,ie,le,!1,null,null,null),fe=pe.exports,he=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.variant_name&&e.rendered?a("div",[a("h3",[e._v("Known PheWAS Results: "+e._s(e.variant_name))]),a("p",[e._v("\n      In your study "),a("em",{staticStyle:{"word-break":"break-word"}},[e._v(e._s(e.your_study))]),e._v(", this variant has a\n      "),a("span",{staticClass:"text-muted definition",attrs:{title:"p-value "+e.display_pvalue}},[e._v("\n        -log"),a("sub",[e._v("10")]),e._v(" p-value of "),a("strong",[e._v(e._s(e.display_logpvalue))])]),e._v(". Below are other\n      results for comparison.\n    ")]),a("lz-plot",{attrs:{base_layout:e.base_phewas_layout,base_sources:e.base_phewas_sources,show_loading:!0},on:{connected:e.receivePlot}})],1):a("p",[e._v("\n    Please select a variant in order to generate a PheWAS plot. You can click on any scatter plot\n    point in an association track.\n  ")]),e._m(0)])},me=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",[e._v("\n    PheWAS results are drawn from a large-scale analysis of the UK Biobank dataset, as described in\n    "),a("a",{attrs:{href:"https://doi.org/10.1038/s41588-018-0184-y"}},[e._v("Nature Genetics volume 50, pages 1335â1341 (2018)")]),e._v(".\n  ")])}],ve=(a("fca0"),{name:"PhewasMaker",beforeCreate:function(){this.plot=null,this.datasources=null},props:["variant_name","build","your_study","your_logpvalue","allow_render"],data:function(){return{rendered:this.allow_render}},computed:{display_logpvalue:function(){return p.a.TransformationFunctions.get("scinotation")(this.your_logpvalue)},display_pvalue:function(){var e=this.your_logpvalue;return Number.isFinite(e)?p.a.TransformationFunctions.get("scinotation")(Math.pow(10,-e)):0},base_phewas_layout:function(){var e=p.a.Layouts.get("data_layer","phewas_pvalues",{unnamespaced:!0,y_axis:{min_extent:[0,10]}}),t=p.a.Layouts.get("panel","phewas",{unnamespaced:!0,data_layers:[e]});return p.a.Layouts.get("plot","standard_phewas",{height:250,min_height:200,panels:[t],responsive_resize:!1,state:{variant:this.variant_name,genome_build:this.build}})},base_phewas_sources:function(){return[["phewas",["PheWASLZ",{url:"https://portaldev.sph.umich.edu/ukbb/v1/statistic/phewas/"}]]]},render_trigger:function(){return this.allow_render,this.variant_name}},methods:{receivePlot:function(e,t){this.plot=e,this.datasources=t,e.subscribeToData(["phewas:id"],(function(t){t&&t.length||e.curtain.show("There is no PheWAS data available for the requested variant. Please try another variant.")})),e.emit("data_rendered")}},watch:{allow_render:function(e){var t=this.variant_name;e&&t&&(this.rendered=!0),this.plot&&t&&(this.plot.curtain.hide(),this.plot.applyState({variant:t}))}},components:{LzPlot:fe}}),be=ve,ge=(a("44c0"),Object(Q["a"])(be,he,me,!1,null,"a6ecca30",null)),ye=ge.exports,we={name:"PlotPanes",props:{assoc_layout:{type:Object},assoc_sources:{type:Array},study_names:{type:Array},chr:{type:String},start:{type:Number},end:{type:Number},build:{type:String,default:"GRCh37"},dynamic_urls:{default:!1},has_credible_sets:{type:Boolean,default:!0}},data:function(){return{selected_tab:0,tmp_phewas_study:null,tmp_phewas_variant:null,tmp_phewas_logpvalue:null,tmp_export_callback:null,table_data:[]}},computed:{allow_phewas:function(){return"GRCh37"===this.build},has_studies:function(){return!!this.study_names.length}},beforeCreate:function(){this.PHEWAS_TAB=1,this.assoc_plot=null,this.assoc_datasources=null},methods:{receivePlot:function(e,t){this.assoc_plot=e,this.assoc_datasources=t},addStudy:function(e,t){R(this.assoc_plot,this.assoc_datasources,e,t)},onVariantClick:function(e){var t=e.sourceID;if(-1!==t.indexOf("association_")){var a=z(e.data,"assoc");this.tmp_phewas_study=t.split(".")[1].replace(/^association_/,""),this.tmp_phewas_variant=a.variant,this.tmp_phewas_logpvalue=a.log_pvalue}},subscribeFields:function(e){var t=this;this.tmp_export_callback&&(this.assoc_plot.off("data_rendered",this.tmp_export_callback),this.tmp_export_callback=null),e.length&&this.assoc_plot&&(this.tmp_export_callback=this.assoc_plot.subscribeToData(e,(function(e){t.table_data=e.map((function(e){return z(e,"assoc")}))})),this.assoc_plot.emit("data_rendered"))}},components:{ExportData:oe,LzPlot:fe,PhewasMaker:ye,BCard:l["a"],BTab:W["a"],BTabs:V["a"]}},Ce=we,xe=(a("a8b7"),Object(Q["a"])(Ce,D,F,!1,null,null,null)),ke=xe.exports,Se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"row"},[e.batch_mode_active?e._e():a("div",{staticClass:"col-sm-6"},[e.study_count<e.max_studies?a("div",[a("tabix-file",{staticClass:"mr-1",on:{ready:e.connectReader,fail:e.showMessage}}),a("b-dropdown",{attrs:{text:"Add from URL",variant:"success"}},[a("div",{staticClass:"px-3"},[a("tabix-url",{on:{ready:e.connectReader,fail:e.showMessage}})],1)]),e.show_modal?a("adder-wizard",{attrs:{file_reader:e.file_reader,file_name:e.display_name},on:{"update:file_name":function(t){e.display_name=t},ready:e.sendConfig,close:function(t){e.show_modal=!1}}}):e._e()],1):e._e()]),e.batch_mode_active?e._e():a("div",{staticClass:"col-sm-6"},[e.study_count?a("div",{staticClass:"d-flex justify-content-end"},[a("region-picker",{attrs:{build:e.build,max_range:e.max_region_size,search_url:"https://portaldev.sph.umich.edu/api/v1/annotation/omnisearch/"},on:{ready:e.selectRange,fail:e.showMessage}}),a("batch-spec",{staticClass:"ml-1",attrs:{max_range:e.max_region_size},on:{ready:e.activateBatchMode}})],1):a("b-dropdown",{staticClass:"float-right",attrs:{text:"Plot options",variant:"info"}},[a("div",{staticClass:"px-3"},[a("strong",[e._v("Annotations")]),a("br"),a("div",{staticClass:"form-check form-check-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.has_catalog,expression:"has_catalog"}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"show-catalog"},domProps:{checked:Array.isArray(e.has_catalog)?e._i(e.has_catalog,null)>-1:e.has_catalog},on:{change:function(t){var a=e.has_catalog,s=t.target,r=!!s.checked;if(Array.isArray(a)){var n=null,o=e._i(a,n);s.checked?o<0&&(e.has_catalog=a.concat([n])):o>-1&&(e.has_catalog=a.slice(0,o).concat(a.slice(o+1)))}else e.has_catalog=r}}}),a("label",{staticClass:"form-check-label",attrs:{for:"show-catalog"}},[e._v("GWAS Catalog")])]),a("div",{staticClass:"form-check form-check-inline"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.has_credible_sets,expression:"has_credible_sets"}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"show-credible-set"},domProps:{checked:Array.isArray(e.has_credible_sets)?e._i(e.has_credible_sets,null)>-1:e.has_credible_sets},on:{change:function(t){var a=e.has_credible_sets,s=t.target,r=!!s.checked;if(Array.isArray(a)){var n=null,o=e._i(a,n);s.checked?o<0&&(e.has_credible_sets=a.concat([n])):o>-1&&(e.has_credible_sets=a.slice(0,o).concat(a.slice(o+1)))}else e.has_credible_sets=r}}}),a("label",{staticClass:"form-check-label",attrs:{for:"show-credible-set"}},[e._v("95% credible set")])]),a("strong",[e._v("Genome Build")]),a("br"),a("div",{staticClass:"form-check"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.build,expression:"build"}],staticClass:"form-check-input",attrs:{type:"radio",id:"build-37",name:"build",value:"GRCh37"},domProps:{checked:e._q(e.build,"GRCh37")},on:{change:function(t){e.build="GRCh37"}}}),a("label",{staticClass:"form-check-label",attrs:{for:"build-37"}},[e._v("GRCh37")])]),a("div",{staticClass:"form-check"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.build,expression:"build"}],staticClass:"form-check-input",attrs:{type:"radio",id:"build-38",name:"build",value:"GRCh38"},domProps:{checked:e._q(e.build,"GRCh38")},on:{change:function(t){e.build="GRCh38"}}}),a("label",{staticClass:"form-check-label",attrs:{for:"build-38"}},[e._v("GRCh38")])])])])],1),e.batch_mode_active?a("div",{staticClass:"col-md-12"},[a("batch-scroller",{attrs:{regions:e.batch_mode_regions},on:{navigate:e.selectRange,cancel:function(t){e.batch_mode_active=!1}}})],1):e._e(),e.message?a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-12"},[a("span",{class:[e.message_class]},[e._v(e._s(e.message))])])]):e._e()])])},Oe=[],Pe=a("dd9a"),Ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"modal"}},[a("div",{staticClass:"modal-mask"},[a("div",{staticClass:"modal-wrapper"},[a("div",{staticClass:"modal-container"},[a("div",{staticClass:"modal-header"},[a("h3",[e._v("Select file options...")]),a("button",{staticClass:"pull-right",attrs:{"aria-label":"close"},on:{click:function(t){return e.$emit("close")}}},[e._v("X\n          ")])]),a("div",{staticClass:"modal-body"},[a("div",[e.current_page===e.PAGES.filename?a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-3",attrs:{for:"display_name"}},[e._v("Dataset Label")]),a("div",{staticClass:"col-sm-9"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.file_name,expression:"file_name"}],staticClass:"form-control",attrs:{id:"display_name",type:"text"},domProps:{value:e.file_name},on:{input:function(t){t.target.composing||(e.file_name=t.target.value)}}})])]):e.current_page===e.PAGES.variant?a("div",[a("b-tabs",{model:{value:e.variant_spec_tab,callback:function(t){e.variant_spec_tab=t},expression:"variant_spec_tab"}},[a("b-tab",{staticClass:"pt-3",attrs:{title:"Variant from columns"}},[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-chr"}},[e._v("Chromosome")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.chrom_col,expression:"chrom_col"}],staticClass:"form-control",attrs:{id:"vs-chr"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.chrom_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,s){return a("option",{key:s,domProps:{value:s+1}},[e._v("\n                          "+e._s(t)+"\n                        ")])})),0)]),a("label",{staticClass:"col-sm-2",attrs:{for:"vs-pos"}},[e._v("Position")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.pos_col,expression:"pos_col"}],staticClass:"form-control",attrs:{id:"vs-pos"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.pos_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,s){return a("option",{key:s,domProps:{value:s+1}},[e._v("\n                          "+e._s(t)+"\n                        ")])})),0)])]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-ref"}},[e._v("Ref allele")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.ref_col,expression:"ref_col"}],staticClass:"form-control",attrs:{id:"vs-ref"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.ref_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,s){return a("option",{key:s,domProps:{value:s+1}},[e._v("\n                          "+e._s(t)+"\n                        ")])})),0)]),a("label",{staticClass:"col-sm-2",attrs:{for:"vs-alt"}},[e._v("Alt allele")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.alt_col,expression:"alt_col"}],staticClass:"form-control",attrs:{id:"vs-alt"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.alt_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,s){return a("option",{key:s,domProps:{value:s+1}},[e._v("\n                          "+e._s(t)+"\n                        ")])})),0)])])]),a("b-tab",{staticClass:"pt-3",attrs:{title:"Variant from marker"}},[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-marker"}},[e._v("Marker")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.marker_col,expression:"marker_col"}],staticClass:"form-control",attrs:{id:"vs-marker"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.marker_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,s){return a("option",{key:s,domProps:{value:s+1}},[e._v("\n                          "+e._s(t)+"\n                        ")])})),0)])])])],1),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-pval"}},[e._v("P-value column")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.pvalue_col,expression:"pvalue_col"}],staticClass:"form-control",attrs:{id:"vs-pval"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.pvalue_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,s){return a("option",{key:s,domProps:{value:s+1}},[e._v("\n                      "+e._s(t)+"\n                    ")])})),0)]),a("div",{staticClass:"col-sm-2"},[a("label",{staticClass:"form-check-label",staticStyle:{"white-space":"nowrap"},attrs:{for:"is_neg_log_pvalue"}},[e._v("\n                    is "),a("em",[e._v("-log"),a("sub",[e._v("10")]),e._v("(p)")])])]),a("div",{staticClass:"col-sm-4"},[a("div",{staticClass:"form-check float-left"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.is_neg_log_pvalue,expression:"is_neg_log_pvalue"}],staticClass:"form-check-input",attrs:{id:"is_neg_log_pvalue",type:"checkbox"},domProps:{checked:Array.isArray(e.is_neg_log_pvalue)?e._i(e.is_neg_log_pvalue,null)>-1:e.is_neg_log_pvalue},on:{change:function(t){var a=e.is_neg_log_pvalue,s=t.target,r=!!s.checked;if(Array.isArray(a)){var n=null,o=e._i(a,n);s.checked?o<0&&(e.is_neg_log_pvalue=a.concat([n])):o>-1&&(e.is_neg_log_pvalue=a.slice(0,o).concat(a.slice(o+1)))}else e.is_neg_log_pvalue=r}}})])])])],1):e.current_page===e.PAGES.optional?a("div",[a("h3",[e._v("Optional fields")]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-beta"}},[e._v("Effect size")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.beta_col,expression:"beta_col"}],staticClass:"form-control",attrs:{id:"vs-beta"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.beta_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,s){return a("option",{key:s,domProps:{value:s+1}},[e._v("\n                      "+e._s(t)+"\n                    ")])})),0)]),a("div",{staticClass:"col-sm-6"})]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-stderr"}},[e._v("Std. Err.")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.stderr_beta_col,expression:"stderr_beta_col"}],staticClass:"form-control",attrs:{id:"vs-stderr"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.stderr_beta_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,s){return a("option",{key:s,domProps:{value:s+1}},[e._v("\n                      "+e._s(t)+"\n                    ")])})),0)])]),a("h4",[e._v("Allele Frequency")]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2"},[e._v("Effect allele")]),a("div",{staticClass:"col-sm-10"},[a("b-form-radio",{attrs:{inline:"",value:!1},model:{value:e.is_alt_effect,callback:function(t){e.is_alt_effect=t},expression:"is_alt_effect"}},[e._v("Ref")]),a("b-form-radio",{attrs:{inline:"",value:!0},model:{value:e.is_alt_effect,callback:function(t){e.is_alt_effect=t},expression:"is_alt_effect"}},[e._v("Alt")])],1)]),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2"},[e._v("Specify from")]),a("div",{staticClass:"col-sm-10"},[a("b-form-radio",{attrs:{inline:"",value:e.AF_SPEC.freq},model:{value:e.freq_spec_option,callback:function(t){e.freq_spec_option=t},expression:"freq_spec_option"}},[e._v("Frequency")]),a("b-form-radio",{attrs:{inline:"",value:e.AF_SPEC.count},model:{value:e.freq_spec_option,callback:function(t){e.freq_spec_option=t},expression:"freq_spec_option"}},[e._v("Counts")])],1)]),e.freq_spec_option===e.AF_SPEC.freq?a("div",[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-af-freq"}},[e._v("Frequency")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.allele_freq_col,expression:"allele_freq_col"}],staticClass:"form-control",attrs:{id:"vs-af-freq"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.allele_freq_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,s){return a("option",{key:s,domProps:{value:s+1}},[e._v("\n                          "+e._s(t)+"\n                        ")])})),0)]),a("div",{staticClass:"col-sm-6"})])]):e.freq_spec_option===e.AF_SPEC.count?a("div",[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-sm-2",attrs:{for:"vs-af-count"}},[e._v("Count")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.allele_count_col,expression:"allele_count_col"}],staticClass:"form-control",attrs:{id:"vs-af-count"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.allele_count_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,s){return a("option",{key:s,domProps:{value:s+1}},[e._v("\n                          "+e._s(t)+"\n                        ")])})),0)]),a("label",{staticClass:"col-sm-2",attrs:{for:"vs-af-ns"}},[e._v("# Samples")]),a("div",{staticClass:"col-sm-4"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.n_samples_col,expression:"n_samples_col"}],staticClass:"form-control",attrs:{id:"vs-af-ns"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.n_samples_col=t.target.multiple?a:a[0]}}},e._l(e.column_titles,(function(t,s){return a("option",{key:s,domProps:{value:s+1}},[e._v("\n                          "+e._s(t)+"\n                        ")])})),0)])])]):a("div",[a("span",{staticClass:"text-muted"},[e._v("\n                    Please select a frequency option in order to use this feature\n                  ")])])]):e._e(),a("div",{staticClass:"row"},[a("div",{staticClass:"card card-body bg-light"},[e.isValid&&e.preview.error?a("div",[a("span",{staticClass:"text-danger"},[e._v(e._s(e.preview.error))])]):e.isValid?a("div",[a("table",{staticClass:"preview-table"},[a("tr",[a("td",[e._v("Variant")]),a("td",[e._v(e._s(e.preview.variant))])]),a("tr",[a("td",[e._v("-log"),a("sub",[e._v("10")]),e._v("(p)")]),a("td",[e._v(e._s(e.preview.log_pvalue.toFixed(3)))])]),a("tr",[a("td",[e._v("Î²")]),a("td",[e._v(e._s(e.preview.beta?e.preview.beta.toFixed(3):""))])]),a("tr",[a("td",[e._v("SE(Î²)")]),a("td",[e._v(e._s(e.preview.stderr_beta?e.preview.stderr_beta.toFixed(3):""))])]),a("tr",[a("td",[e._v("Allele freq")]),a("td",[e._v("\n                          "+e._s(e.preview.alt_allele_freq?e.preview.alt_allele_freq.toFixed(3):"")+"\n                        ")])])])]):a("div",[e._v("\n                    Please select options to preview parsed data.\n                  ")])])]),a("div",{staticClass:"row mt-3"},[e.current_page===e.PAGES.optional?a("button",{staticClass:"btn btn-success ml-auto",attrs:{disabled:!e.isValid},on:{click:e.sendOptions}},[e._v("\n                Accept options\n              ")]):a("button",{staticClass:"btn btn-success ml-auto",attrs:{disabled:!e.isValid},on:{click:function(t){e.current_page+=1}}},[e._v("Next\n              ")])])])])])])])])},je=[],Ee=(a("20d6"),a("8226")),qe=a("9e14");a("6c7b");function Ne(e){return!!g.has(e)||!Number.isNaN(+e)}function Le(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.comment_char,s=void 0===a?"#":a,r=t.delimiter,n=void 0===r?"\t":r;return e.startsWith(s)||e.split(n).every((function(e){return!Ne(e)}))}function Re(e,t){for(var a=Array(t.length+1).fill(null).map((function(){return Array(e.length+1).fill(null)})),s=0;s<=e.length;s+=1)a[0][s]=s;for(var r=0;r<=t.length;r+=1)a[r][0]=r;for(var n=1;n<=t.length;n+=1)for(var o=1;o<=e.length;o+=1){var i=e[o-1]===t[n-1]?0:1;a[n][o]=Math.min(a[n][o-1]+1,a[n-1][o]+1,a[n-1][o-1]+i)}return a[t.length][e.length]}function $e(e,t){for(var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,s=a+1,r=null,n=function(a){var n=t[a];if(null===n)return"continue";var o=Math.min.apply(Math,Object(d["a"])(e.map((function(e){return Re(n,e)}))));o<s&&(s=o,r=a)},o=0;o<t.length;o++)n(o);return r}function Te(e,t){var a,s=["neg_log_pvalue","log_pvalue","log_pval","logpvalue"],r=["pvalue","p.value","p-value","pval","p_score","p"],n=function(e,t,s){var r=x(t.map((function(t){return t[e]})));try{a=r.map((function(e){return S(e,s)}))}catch(n){return!1}return a.every((function(e){return!Number.isNaN(e)}))},o=$e(s,e),i=$e(r,e);return null!==o&&n(o,t,!0)?{pvalue_col:o+1,is_neg_log_pvalue:!0}:i&&n(i,t,!1)?{pvalue_col:i+1,is_neg_log_pvalue:!1}:null}function ze(e,t){var a=["snpid","marker","markerid","snpmarker","chr:position"],s=["chrom","chr"],r=["position","pos","begin","beg","bp","end","ps"],n=["A1","ref","reference","allele0","allele1"],o=["A2","alt","alternate","allele1","allele2"],i=t[0],l=$e(a,e);if(null!==l&&k(i[l],!0))return l+=1,{marker_col:l};for(var c=e.slice(),u=[["chrom_col",s],["pos_col",r],["ref_col",n],["alt_col",o]],d={},_=0;_<u.length;_++){var p=Object(b["a"])(u[_],2),f=p[0],h=p[1],m=$e(h,c);if(null===m)return null;d[f]=m+1,c[m]=null}return d}function Ge(e,t){var a=["beta","effect_size","alt_effsize","effect"],s=["stderr_beta","stderr","sebeta","effect_size_sd","se"];function r(e,t){var a,s=x(t.map((function(t){return t[e]})));try{a=s.filter((function(e){return null!==e})).map((function(e){return+e}))}catch(r){return!1}return a.every((function(e){return!Number.isNaN(e)}))}var n=$e(a,e,0),o=$e(s,e,0),i={};return null!==n&&r(n,t)&&(i.beta_col=n+1),null!==o&&r(o,t)&&(i.stderr_beta_col=o+1),i}function Me(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=e.map((function(e){return e?e.toLowerCase():e}));s[0].replace("/^#+/","");var r=Te(s,t,a);if(!r)return null;s[r.pvalue_col-1]=null;var n=ze(s,t);if(!n)return null;Object.keys(n).forEach((function(e){s[n[e]]=null}));var o=Ge(s,t);return r&&n?Object.assign({},r,n,o||{}):null}var Be=0,De=1,Fe={freq:1,count:2},We={filename:0,variant:1,optional:2},Ve={name:"adder-wizard",beforeCreate:function(){this.PAGES=We,this.AF_SPEC=Fe},mounted:function(){var e=this;document.body.addEventListener("keyup",(function(t){"Escape"===t.key&&e.$emit("close")}))},props:["file_reader","file_name"],data:function(){return{column_titles:[],sample_data:[],current_page:this.filename?We.filename:We.variant,variant_spec_tab:Be,freq_spec_option:null,marker_col:null,chrom_col:this.file_reader.colSeq||null,pos_col:this.file_reader.colStart||null,ref_col:null,alt_col:null,pvalue_col:null,is_neg_log_pvalue:!1,beta_col:null,stderr_beta_col:null,allele_freq_col:null,allele_count_col:null,n_samples_col:null,is_alt_effect:null}},watch:{file_reader:{immediate:!0,handler:function(){var e=this,t=function(t,a){var s;s=e.file_reader.skip?e.file_reader.skip:t.findIndex((function(e){return!Le(e)})),e.sample_data=t.slice(s);var r=e.sample_data.map((function(e){return e.split("\t")}));if(s>0){e.column_titles=t[s-1].replace(/^#+/g,"").split("\t");var n=Me(e.column_titles,r);n&&(Object.assign(e,n),e.variant_spec_tab=C(n.marker_col)?De:Be)}else{var o=t.length?t[0].split("\t").length:0;e.column_titles=Object(d["a"])(new Array(o)).map((function(e,t){return"Column ".concat(t+1)}))}};this.file_reader.fetchHeader(t,{nLines:30,metaOnly:!1})}}},computed:{freqSpec:function(){var e=this.freq_spec_option,t=this.allele_freq_col,a=this.allele_count_col,s=this.n_samples_col,r=this.is_alt_effect,n={is_alt_effect:r},o=null!==r;return e===Fe.freq?(o=o&&C(t),n.allele_freq_col=t):e===Fe.count&&(o=o&&C(a)&&C(s),n.allele_count_col=a,n.n_samples_col=s),o?n:{}},variantSpec:function(){var e=this.marker_col,t=this.chrom_col,a=this.pos_col,s=this.ref_col,r=this.alt_col;if(this.variant_spec_tab===De&&C(e))return{marker_col:e};if(this.variant_spec_tab===Be&&C(a)&&C(t)){var n={chrom_col:t,pos_col:a};return C(s)&&C(r)&&Object.assign(n,{ref_col:s,alt_col:r}),n}return{}},parserOptions:function(){var e=this.pvalue_col,t=this.is_neg_log_pvalue,a=this.beta_col,s=this.stderr_beta_col;return Object.assign({},{pvalue_col:e,is_neg_log_pvalue:t,beta_col:a,stderr_beta_col:s},this.variantSpec,this.freqSpec)},isValid:function(){var e=0!==Object.keys(this.variantSpec).length,t=C(this.parserOptions.pvalue_col);return e&&t},parser:function(){if(this.isValid)try{return P(this.parserOptions)}catch(e){return function(){throw new Error("Invalid parser configuration")}}return function(){}},preview:function(){try{return this.parser(this.sample_data[0])}catch(e){return console.error(e),{error:"Could not parse column contents"}}}},methods:{sendOptions:function(){var e=this.preview.position,t={chr:this.preview.chromosome,start:Math.max(0,e-25e4),end:e+25e4};this.$emit("ready",Object.assign({},this.parserOptions),t),this.$emit("close")}},components:{BFormGroup:Ee["a"],BFormRadio:qe["a"],BTab:W["a"],BTabs:V["a"]}},Ue=Ve,Ze=(a("cab7"),Object(Q["a"])(Ue,Ae,je,!1,null,"08efba04",null)),Ie=Ze.exports,He=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-dropdown",{ref:"dropdown",attrs:{variant:"info",right:"",text:"Batch view"}},[a("div",{staticClass:"px-3"},[a("label",{attrs:{for:"batch-region-list"}},[e._v("Specify regions to plot (one per line):")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.region_text,expression:"region_text"}],attrs:{id:"batch-region-list",rows:"10",placeholder:"chr:start-end or chr:pos"},domProps:{value:e.region_text},on:{input:function(t){t.target.composing||(e.region_text=t.target.value)}}}),e.message?a("div",{staticClass:"text-danger"},[e._v(e._s(e.message))]):e._e(),a("div",{staticClass:"d-flex justify-content-end align-items-center"},[e.show_loader?a("div",{staticClass:"d-flex align-items-center spinner-border   text-secondary mr-1",attrs:{role:"status"}},[a("span",{staticClass:"sr-only"},[e._v("Loading...")])]):e._e(),e._t("preset-button",null,{updateRegions:e.updateRegions}),a("button",{staticClass:"btn btn-success ml-1",on:{click:e.sendRegions}},[e._v("Go")])],2)])])],1)},Je=[];a("6b54");function Ke(e,t){var a=t.region_size,s=void 0===a?5e5:a,r=Math.floor(s/2);return[Math.max(e-r,1),e+r]}function Ye(e,t){var a,s,r,n=t.region_size,o=void 0===n?5e5:n,i=e.match(v),l=e.match(m);if(i){var c=i.slice(1),u=Object(b["a"])(c,3);a=u[0],s=u[1],r=u[2],s=+s,r=+r}else{if(!l)throw new Error("Could not parse the specified range: ".concat(e));var d,_=l.slice(1),p=Object(b["a"])(_,2);a=p[0],d=p[1],d=+d;var f=Ke(d,{region_size:o}),h=Object(b["a"])(f,2);s=h[0],r=h[1]}if(o&&r-s>o)throw new Error("Maximum allowable range is ".concat(o.toLocaleString()));return{chr:a,start:s,end:r}}var Xe={name:"BatchSpec",props:{max_range:Number},data:function(){return{region_text:"",show_loader:!1,message:null}},methods:{getRegionsFromTextBox:function(){var e=this,t=this.region_text.trim().split(/\r?\n/).filter((function(e){return!!e}));return t.map((function(t){return Ye(t,{region_size:e.max_range})}))},validateRegions:function(e){return!!e.length},updateRegions:function(e){var t=this;this.show_loader=!0,Promise.resolve(e).then((function(e){return e.map((function(e){var t=e.chr,a=e.start,s=e.end;return"".concat(t,":").concat(a,"-").concat(s)})).join("\n")})).then((function(e){t.region_text=e})).catch((function(e){t.message="Unable to retrieve items"})).finally((function(){t.show_loader=!1}))},sendRegions:function(){var e;try{e=this.getRegionsFromTextBox()}catch(t){return void(this.message=t.toString())}e.length?(this.message="",this.$emit("ready",e),this.$refs.dropdown.hide()):this.message="Must specify at least one region"}},components:{BDropdown:Pe["a"]}},Qe=Xe,et=Object(Q["a"])(Qe,He,Je,!1,null,"bd94ef54",null),tt=et.exports,at=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"alert-success d-flex justify-content-between align-items-center"},[a("button",{staticClass:"btn btn-link",attrs:{disabled:this.current_index<=0},on:{click:function(t){return e.goToItem(-1)}}},[e._v("< Prev")]),a("span",[e._v("\n    Current Locus: "+e._s(e.current_region_display)+" -\n    "),null!==this.current_index?a("span",[e._v("\n      ("+e._s(this.current_index+1)+" of "+e._s(this.regions.length)+") -\n    ")]):e._e(),a("button",{staticClass:"btn btn-link p-0 border-0 align-bottom",attrs:{title:"Cancel navigation"},on:{click:e.cancelNavigation}},[e._v("cancel batch mode")])]),a("button",{staticClass:"btn btn-link",attrs:{disabled:null!==this.current_index&&this.current_index>=this.regions.length-1},on:{click:function(t){return e.goToItem(1)}}},[e._v("Next >")])])},st=[],rt={name:"BatchScroller",props:["regions"],data:function(){return{current_index:null}},methods:{cancelNavigation:function(){this.$emit("cancel")},goToItem:function(e){null===this.current_index?this.current_index=0:this.current_index+=e,this.$emit("navigate",this.current_region)}},computed:{current_region:function(){return null===this.current_index?null:this.regions[this.current_index]},current_region_display:function(){var e=this.current_region;if(!e)return"(none)";var t=e.chr,a=e.start,s=e.end;return"".concat(t,": ").concat(a.toLocaleString(),"-").concat(s.toLocaleString())}}},nt=rt,ot=Object(Q["a"])(nt,at,st,!1,null,"29bd5af0",null),it=ot.exports,lt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-inline"},[a("vue-bootstrap-typeahead",{attrs:{data:e.search_results,serializer:function(e){return e.term},"min-matching-chars":3,placeholder:"chr:start-end, rs, or gene"},model:{value:e.region,callback:function(t){e.region=t},expression:"region"}}),a("button",{staticClass:"btn btn-primary",on:{click:e.selectRegion}},[e._v("Go to region")])],1)},ct=[],ut=(a("7514"),a("2ef0")),dt=a("d45f"),_t={name:"region-picker",components:{VueBootstrapTypeahead:dt["a"]},props:{max_range:{type:Number,default:5e5},search_url:{type:String,default:"https://portaldev.sph.umich.edu/api/v1/annotation/omnisearch/"},build:{type:String,required:!0}},data:function(){return{region:null,search_results:[]}},methods:{selectRegion:function(){var e=this,t=this.max_range;if(this.region){var a,s,r,n=this.search_results.find((function(t){return e.region===t.term}));if(n){a=n.chrom,s=n.start,r=n.end;var o=Ke((s+r)/2,{region_size:t}),i=Object(b["a"])(o,2);s=i[0],r=i[1]}else{try{var l=Ye(this.region,{region_size:t});a=l.chr,s=l.start,r=l.end}catch(c){return void this.$emit("fail","Could not parse specified range")}if(r-s>this.max_range)return void this.$emit("fail","Maximum allowable range is ".concat(t.toLocaleString()))}this.$emit("ready",{chr:a,start:s,end:r})}else this.$emit("fail","Please specify a region")},doSearch:function(){var e=this;this.search_results=[];var t="".concat(this.search_url,"?q=").concat(encodeURIComponent(this.region),"&build=").concat(encodeURIComponent(this.build));fetch(t).then((function(e){if(e.ok)return e.json();throw new Error("Server error")})).then((function(t){e.search_results=t.data.filter((function(e){return!e.error&&"region"!==e.type}))})).catch((function(){return e.$emit("fail","Could not perform the specified search")}))}},watch:{region:Object(ut["debounce"])((function(){this.doSearch()}),500)}},pt=_t,ft=Object(Q["a"])(pt,lt,ct,!1,null,"5948190c",null),ht=ft.exports,mt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",[a("label",{staticClass:"btn btn-success mb-0",attrs:{for:"file-picker"}},[e._v("Add a file...")]),a("input",{staticStyle:{opacity:"0",width:"0",height:"0"},attrs:{id:"file-picker",type:"file",multiple:"",accept:"application/gzip,.tbi"},on:{change:function(t){return e.addSource(t)}}})])},vt=[],bt=(a("7f7f"),a("aef6"),a("1d63")),gt={methods:{addSource:function(e){for(var t,a,s=this,r=e.target.files,n=0;n<r.length;n++){var o=r.item(n);o.name.endsWith(".tbi")?t=o:a=o}if(2===r.length&&t){var i=t.name.replace(/\.gz|\.tbi/gi,"");Object(bt["a"])(a,t).then((function(e){s.$emit("ready",e,i)})).catch((function(e){s.$emit("fail",e)})).finally((function(){e.target.value=null}))}else s.$emit("fail","Must select two files: gzipped data and accompanying tabix index")}}},yt=gt,wt=Object(Q["a"])(yt,mt,vt,!1,null,null,null),Ct=wt.exports,xt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-inline flex-nowrap"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.url,expression:"url",modifiers:{trim:!0}}],staticClass:"form-control mr-1",attrs:{type:"url",placeholder:"Specify a URL"},domProps:{value:e.url},on:{input:function(t){t.target.composing||(e.url=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),a("button",{staticClass:"btn btn-success",on:{click:e.addSource}},[e._v("Add")])])},kt=[],St={data:function(){return{url:""}},methods:{addSource:function(){var e=this,t="".concat(this.url,".tbi"),a=t.split("/").pop().replace(/\.gz|\.tbi/gi,"");Object(bt["b"])(this.url,t).then((function(t){e.$emit("ready",t,a)})).catch((function(t){e.$emit("fail",t)}))}}},Ot=St,Pt=Object(Q["a"])(Ot,xt,kt,!1,null,null,null),At=Pt.exports,jt=1e6,Et={name:"gwas-toolbar",props:{max_studies:{type:Number,default:3},study_names:{type:[Array,null],default:null}},data:function(){return{max_region_size:jt,show_modal:!1,num_studies_added:0,message:"",message_class:"",file_reader:null,display_name:null,has_catalog:!1,has_credible_sets:!1,build:"GRCh37",batch_mode_active:!1,batch_mode_regions:[]}},computed:{study_count:function(){return this.study_names?this.study_names.length:this.num_studies_added}},methods:{reset:function(){this.file_reader=null,this.display_name=null,this.batch_mode_active=!1,this.batch_mode_regions=[],this.showMessage("","")},showMessage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text-danger";this.message=e,this.message_class=t},selectRange:function(e){this.showMessage("",""),this.$emit("select-range",e)},connectReader:function(e,t){this.file_reader=e,this.display_name=t,this.show_modal=!0},activateBatchMode:function(e){this.batch_mode_active=!0,this.batch_mode_regions=e},sendConfig:function(e,t){this.num_studies_added+=1;var a={gwas_catalog:this.has_catalog,credible_sets:this.has_credible_sets},s=this.build;this.$emit("config-ready",{label:this.display_name,reader:this.file_reader,parser_config:e},{annotations:a,build:s,state:Object.assign({genome_build:this.build},t)}),this.reset()}},components:{BDropdown:Pe["a"],AdderWizard:Ie,BatchScroller:it,BatchSpec:tt,RegionPicker:ht,TabixFile:Ct,TabixUrl:At}},qt=Et,Nt=Object(Q["a"])(qt,Se,Oe,!1,null,null,null),Lt=Nt.exports,Rt={name:"LocalZoom",data:function(){return{base_assoc_layout:null,base_assoc_sources:null,chr:null,start:null,end:null,build:null,study_names:[],has_credible_sets:!1}},methods:{receiveAssocOptions:function(e,t){var a=e.label,s=e.reader,r=e.parser_config,n=L(a,s,r),o=t.annotations,i=t.build,l=t.state,c=N(a,o,i);o.credible_sets&&(this.has_credible_sets=!0),this.updateRegion(l),this.study_names.length?this.$refs.plotWidget.addStudy(c,n):(this.base_assoc_sources=$(n),this.base_assoc_layout=T(l,c,{responsive_resize:!1}),B()),this.study_names.push(a),this.build=i},updateRegion:function(e){this.chr=e.chr,this.start=e.start,this.end=e.end}},components:{GwasToolbar:Lt,BCollapse:i["a"],BCard:l["a"],PlotPanes:ke},directives:{VBToggle:c["a"]}},$t=Rt,Tt=Object(Q["a"])($t,n,o,!1,null,"341ceced",null),zt=Tt.exports;r["init"]({dsn:"https://930af71733d64f58ab10d4184a90aee5@sentry.io/1353197",integrations:[new r["Integrations"].Vue({Vue:s["a"]})]}),new s["a"]({render:function(e){return e(zt)}}).$mount("#app")},a8b7:function(e,t,a){"use strict";var s=a("07d3"),r=a.n(s);r.a},cab7:function(e,t,a){"use strict";var s=a("2aab"),r=a.n(s);r.a}});
//# sourceMappingURL=app.f6ef7368.js.map